{"ast":null,"code":"import _defineProperty from\"/Users/shengjiayu/Documents/GitHub/cs185-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/shengjiayu/Documents/GitHub/cs185-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/shengjiayu/Documents/GitHub/cs185-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/shengjiayu/Documents/GitHub/cs185-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/shengjiayu/Documents/GitHub/cs185-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/shengjiayu/Documents/GitHub/cs185-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Axios from'axios';import{PopupboxManager,PopupboxContainer}from'react-popupbox';import'react-popupbox/dist/react-popupbox.css';import config from'../config';var firebase=require('firebase');export var AddMovie=/*#__PURE__*/function(_Component){_inherits(AddMovie,_Component);var _super=_createSuper(AddMovie);function AddMovie(){var _this;_classCallCheck(this,AddMovie);_this=_super.call(this);_this.loadMovies=function(){if(_this.state.currentList.name==='All'){var ref=firebase.database().ref('movies').orderByChild('title').limitToFirst(_this.state.moviesToLoad);ref.on('child_added',function(snapshot){var movie=snapshot.val();var last=movie.title;// console.log(movie);\nvar movies=_this.state.movies;movies.push(movie);_this.setState({'movies':movies,'last':last,'loaded':_this.state.loaded+1%_this.state.moviesToLoad,'loading':_this.state.loaded+1<_this.state.moviesToLoad});});}var movieIDs=_this.getID();movieIDs.forEach(function(movieID){var ref=firebase.database().ref('movies').orderByChild('id').equalTo(movieID).limitToFirst(1);ref.on('child_added',function(snapshot){var movie=snapshot.val();var last=movie.title;if(_this.state.currentList.name!=='All'){var show=false;movieIDs.forEach(function(movieID){if(movie.id===movieID)show=true;});if(!show)return;}var movies=_this.state.movies;movies.push(movie);_this.setState({'movies':movies,'last':last,'loaded':_this.state.loaded+1%_this.state.moviesToLoad,'loading':_this.state.loaded+1<_this.state.moviesToLoad});});});};_this.loadMore=function(){if(_this.state.loading)return;_this.setState({loading:true,loaded:0});var ref=firebase.database().ref('movies').orderByChild('title').startAt(_this.state.last).limitToFirst(_this.state.moviesToLoad+1);var movieIDs=[];if(_this.state.currentList.name!=='All')movieIDs=_this.getID();ref.on('child_added',function(snapshot){var movie=snapshot.val();var duplicate=false;_this.state.movies.forEach(function(m){if(m.id===movie.id)duplicate=true;});if(duplicate)return;if(_this.state.currentList.name!=='All'){var show=false;movieIDs.forEach(function(movieID){if(movie.id===movieID)show=true;});if(!show)return;}var movies=_this.state.movies;movies.push(movie);var last=movie.title;_this.setState({'movies':movies,'last':last,'loaded':_this.state.loaded+1%_this.state.moviesToLoad,'loading':_this.state.loaded+1<_this.state.moviesToLoad});// if ()\n});};_this.addMovie=function(event){event.preventDefault();if(_this.state.movieID.slice(0,2)!=='tt'||!/^\\d+$/.test(_this.state.movieID.slice(2))){var title=_this.state.movieID;_this.setState({'movieID':''});Axios.get('https://www.omdbapi.com/?apikey='+'ec05d9ae'+'&t='+title).then(function(response){if(response.data.Response==='False'){alert('Movie cannot be found! Try another one.');return;}var duplicate=false;_this.state.movies.forEach(function(movie){if(movie.id===response.data.imdbID)duplicate=true;});if(duplicate){alert('Movie existed!');return;}var movie=[];movie.id=response.data.imdbID;movie.title=response.data.Title;movie.director=response.data.Director;movie.year=response.data.Year;movie.plot=response.data.Plot;movie.rating=response.data.imdbRating;movie.poster=response.data.Poster;movie.actors=response.data.Actors.split(', ');firebase.database().ref('movies').push().set(movie);});return;}var id=_this.state.movieID;_this.setState({'movieID':''});var duplicate=false;_this.state.movies.forEach(function(movie){if(movie.id===id)duplicate=true;});if(duplicate){alert('Movie existed!');return;}Axios.get('https://www.omdbapi.com/?apikey='+'ec05d9ae'+'&i='+id).then(function(response){if(response.data.Response==='False'){alert('Movie not found!');return;}var movie=[];movie.id=id;movie.title=response.data.Title;movie.director=response.data.Director;movie.year=response.data.Year;movie.plot=response.data.Plot;movie.rating=response.data.imdbRating;movie.poster=response.data.Poster;movie.actors=response.data.Actors.split(', ');firebase.database().ref('movies').push().set(movie);window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});});};_this.addList=function(event){event.preventDefault();console.log('addList: '+_this.state.listName);var listName=_this.state.listName;_this.setState({'listName':''});var duplicate=false;Object.entries(_this.state.lists).forEach(function(list){if(listName.toLowerCase()===list[1].toLowerCase())duplicate=true;});if(duplicate){alert('List already exists!');return;};var ref=firebase.database().ref('lists');var listRefKey=ref.push().key;var updates={};updates['/lists/'+listRefKey+'/id']=listRefKey;updates['/lists/'+listRefKey+'/name']=listName;alert('List is successfully added!');firebase.database().ref().update(updates);};_this.getupdatess=function(){return Object.entries(_this.state.lists).map(function(list){return/*#__PURE__*/React.createElement(\"option\",{key:list[0],value:list[0]},list[1]);});};_this.getAddToLists=function(id){return Object.entries(_this.state.lists).map(function(list,i){return/*#__PURE__*/React.createElement(\"option\",{key:list[0],value:list[0]},list[1]);});};_this.updates=function(event){var listName='';if(event.target.value===''){listName='All';}else{listName=_this.state.lists[event.target.value];}_this.setState({movies:[],currentList:{id:event.target.value,name:listName},loaded:0,loading:true});_this.forceUpdate(_this.loadMovies);};_this.addToList=function(event,movieID,movieClass){var listID=event.target.value;var duplicate=false;_this.state.movieListPairs.forEach(function(movieListPair){var pair=movieListPair.split(' - ');if(pair[0]===listID&&pair[1]===movieID)duplicate=true;});if(duplicate){alert('Movie already in the selected list!');return;};alert('Added '+movieID+' to '+_this.state.lists[event.target.value]);if(_this.state.lists[event.target.value]==\"GraphViz\"){_this.addGraph(movieClass);alert('Now you can find '+movieClass.title+\" in Graph!\");};};_this.getID=function(){var movieIDs=[];_this.state.movieListPairs.forEach(function(movieListPair){if(movieListPair.search(_this.state.currentList.id)>-1){movieIDs.push(movieListPair.slice((_this.state.currentList.id+' - ').length));}});return movieIDs;};_this.search=function(event){event.preventDefault();};_this.checkGraphMovie=function(id){var movies=_this.state.graphList;for(var i=0;i<movies.length;i++){if(movies[i].id===id)return true;}return false;};_this.addGraph=function(movie){var exists=_this.checkGraphMovie(movie.id);if(exists){var ref=firebase.database().ref('graph');var removeMovie=ref.orderByChild('id').equalTo(movie.id).limitToFirst(1).on('child_added',function(snapshot){ref.child(snapshot.key).remove();});ref.off('child_added',removeMovie);}else{console.log(movie.title);alert('Current movie is not in graph');firebase.database().ref('graph').push().set(movie);}_this.displayLightbox(movie);};_this.deleteMovie=function(movieID){console.log('deleteMovie');var ref=firebase.database().ref('movies');ref.orderByChild('id').equalTo(movieID).limitToFirst(1).on('child_added',function(snapshot){console.log(snapshot.key);ref.child(snapshot.key).remove();});var movies=_this.state.movies;var toDelete=-1;movies.forEach(function(movie,i){if(movie.id===movieID)toDelete=i;});movies.splice(toDelete,1);_this.setState({movies:movies});PopupboxManager.close();};_this.handleChange=function(event){_this.setState(_defineProperty({},event.target.name,event.target.value));};_this.lockScroll=function(){document.body.style.overflow='hidden';};_this.unlockScroll=function(){document.body.style.overflow='inherit';};_this.displayMovies=function(){return _this.state.movies.filter(function(movie){return movie.title.toLowerCase().includes(_this.state.searchQuery);}).map(function(movie){return/*#__PURE__*/React.createElement(\"img\",{className:\"moviePoster\",src:movie.poster,key:movie.id,alt:\"\",onMouseEnter:_this.dimPoster,onMouseLeave:_this.resetPoster,onClick:_this.displayLightbox.bind(_assertThisInitialized(_this),movie)});});};_this.displayLightbox=function(movie){var content=/*#__PURE__*/React.createElement(\"div\",{className:\"movLightboxContainer\"},/*#__PURE__*/React.createElement(\"img\",{className:\"movLightboxImage\",src:movie.poster,alt:\"\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"movLightboxContent\"},/*#__PURE__*/React.createElement(\"span\",{className:\"title\"},movie.title),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"span\",{className:\"director\"},\"Directed by: \",/*#__PURE__*/React.createElement(\"b\",null,movie.director)),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"p\",null,movie.plot),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"span\",{className:\"rating\"},\"Rating: \",/*#__PURE__*/React.createElement(\"b\",null,movie.rating)),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"select\",{className:\"dropdown\",value:_this.state.addToListName,onChange:function onChange(event){_this.addToList(event,movie.id,movie);}},/*#__PURE__*/React.createElement(\"option\",{hidden:true,value:\"\"},\"Add to List\"),_this.getAddToLists(movie.id))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"button\",{className:\"add-to-graph-button\",onClick:function onClick(){return _this.addGraph(movie);}},_this.checkGraphMovie(movie.id)?'Remove from Graph':'Checking in graph'),/*#__PURE__*/React.createElement(\"button\",{className:\"delete-button-add\",onClick:function onClick(){_this.deleteMovie(movie.id);}},\"Delete From Collection\"))));PopupboxManager.open({content:content,config:{onOpen:_this.lockScroll,onClosed:_this.unlockScroll}});};_this.state={movies:[],moviesToLoad:8,last:'',loaded:0,loading:true,movieID:'',listName:'',lists:{},movieListPairs:[],addToListName:'Add to List',currentList:{id:'',name:'All'},searchQuery:'',graphList:[],maxLoaded:false};_this.wrapper=React.createRef();_this.setState({loading:false});return _this;}_createClass(AddMovie,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;document.title='Categorized Movies';if(!firebase.apps.length){firebase.initializeApp(config);}this.loadMovies();var ref=firebase.database().ref('lists');ref.orderByChild('name').on('value',function(snapshot){if(!snapshot.val())return;var lists={};Object.values(snapshot.val()).forEach(function(list){lists[list.id]=list.name;});_this2.setState({lists:lists});});//new\nref=firebase.database().ref('movie-lists');ref.orderByKey().on('value',function(snapshot){if(!snapshot.val())return;var movieLists=[];Object.values(snapshot.val()).forEach(function(movieListPair){var pair=Object.entries(movieListPair)[0];movieLists.push(pair[0]+' - '+pair[1]);});_this2.setState({movieListPairs:movieLists});});ref=firebase.database().ref('graph');ref.on('child_added',function(snapshot){var movie=snapshot.val();var movies=_this2.state.graphList;movies.push(movie);_this2.setState({'graphList':movies});});ref.on('child_removed',function(snapshot){var movie=snapshot.val();var movies=_this2.state.graphList;for(var i=0;i<movies.length;i++){if(movies[i].id===movie.id){movies.splice(i,1);break;}}_this2.setState({'graphList':movies});});//new\n}// componentWillUnmount() {\n//     this.;\n// }\n},{key:\"dimPoster\",value:function dimPoster(e){e.target.style.opacity=0.5;}},{key:\"resetPoster\",value:function resetPoster(e){e.target.style.opacity=1;}},{key:\"render\",value:function render(){var _this3=this;var popupboxConfig={style:{overflow:'inherit'}};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,\"Movies Collection \"),/*#__PURE__*/React.createElement(\"div\",{className:\"movie-forms\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown\"},/*#__PURE__*/React.createElement(\"select\",{onChange:this.updates},/*#__PURE__*/React.createElement(\"option\",{value:\"\"},\"All\"),this.getupdatess())),/*#__PURE__*/React.createElement(\"div\",{className:\"movie-add-forms\"},/*#__PURE__*/React.createElement(\"form\",{className:\"movie-form\",onSubmit:function onSubmit(e){return _this3.addMovie(e);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"movieID\",className:\"form-input-text\",value:this.state.movieID,onChange:function onChange(e){return _this3.handleChange(e);},placeholder:\"Movie title or IMDB ID\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Add a Movie\"}))),/*#__PURE__*/React.createElement(\"form\",{className:\"movie-form\",onSubmit:function onSubmit(e){return _this3.addList(e);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"listName\",className:\"form-input-text\",value:this.state.listName,onChange:function onChange(e){return _this3.handleChange(e);},placeholder:\"Enter a new list name\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Create List\"}))),/*#__PURE__*/React.createElement(\"form\",{className:\"movie-form\",onSubmit:function onSubmit(e){return _this3.search(e);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",null,/*#__PURE__*/React.createElement(\"span\",null,\"Search By Name: \")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"searchQuery\",className:\"form-input-text\",value:this.state.searchQuery,onChange:function onChange(e){return _this3.handleChange(e);},placeholder:\"Enter a name\"}))))),/*#__PURE__*/React.createElement(\"div\",null)),/*#__PURE__*/React.createElement(\"div\",{className:\"movies\",ref:this.moviesScroll},this.displayMovies(),/*#__PURE__*/React.createElement(PopupboxContainer,popupboxConfig)),/*#__PURE__*/React.createElement(\"div\",{className:\"button\"},!this.state.loading&&/*#__PURE__*/React.createElement(\"button\",{className:\"but\",onClick:this.loadMore},\"Load More ...\")));}}]);return AddMovie;}(Component);export default AddMovie;","map":{"version":3,"sources":["/Users/shengjiayu/Documents/GitHub/cs185-react/src/Components/AddMovie.js"],"names":["React","Component","Axios","PopupboxManager","PopupboxContainer","config","firebase","require","AddMovie","loadMovies","state","currentList","name","ref","database","orderByChild","limitToFirst","moviesToLoad","on","snapshot","movie","val","last","title","movies","push","setState","loaded","movieIDs","getID","forEach","movieID","equalTo","show","id","loadMore","loading","startAt","duplicate","m","addMovie","event","preventDefault","slice","test","get","then","response","data","Response","alert","imdbID","Title","director","Director","year","Year","plot","Plot","rating","imdbRating","poster","Poster","actors","Actors","split","set","window","scrollTo","top","document","body","scrollHeight","behavior","addList","console","log","listName","Object","entries","lists","list","toLowerCase","listRefKey","key","updates","update","getupdatess","map","getAddToLists","i","target","value","forceUpdate","addToList","movieClass","listID","movieListPairs","movieListPair","pair","addGraph","search","length","checkGraphMovie","graphList","exists","removeMovie","child","remove","off","displayLightbox","deleteMovie","toDelete","splice","close","handleChange","lockScroll","style","overflow","unlockScroll","displayMovies","filter","includes","searchQuery","dimPoster","resetPoster","bind","content","addToListName","open","onOpen","onClosed","maxLoaded","wrapper","createRef","apps","initializeApp","values","orderByKey","movieLists","e","opacity","popupboxConfig","moviesScroll"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Axios from 'axios';\nimport { PopupboxManager, PopupboxContainer } from 'react-popupbox';\nimport 'react-popupbox/dist/react-popupbox.css'; \nimport config from '../config';\n\nconst firebase = require('firebase');\n\nexport class AddMovie extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tmovies: [],\n\t\t\tmoviesToLoad: 8,\n\t\t\tlast: '',\n\t\t\tloaded: 0,\n\t\t\tloading: true,\n\t\t\tmovieID: '',\n\t\t\tlistName: '',\n\t\t\tlists: {},\n\t\t\tmovieListPairs: [],\n\t\t\taddToListName: 'Add to List',\n\t\t\tcurrentList: {id: '', name: 'All'},\n\t\t\tsearchQuery: '',\n            graphList: [],\n            maxLoaded: false\n\t\t};\n\t\tthis.wrapper = React.createRef();\n\n        this.setState({loading:false});\n\t}\n\n\tcomponentDidMount() {\n        document.title = 'Categorized Movies';\n\t\tif (!firebase.apps.length) {\n\t\t\tfirebase.initializeApp(config);\n\t\t}\n\n\t\tthis.loadMovies();\n\n\t\tlet ref = firebase.database().ref('lists');\n\t\tref.orderByChild('name').on('value', snapshot => {\n\t\t\tif (!snapshot.val()) return;\n\t\t\t\n\t\t\tlet lists = {};\n\t\t\t\n\t\t\tObject.values(snapshot.val()).forEach(list => {\n\t\t\t\tlists[list.id] = list.name;\n\t\t\t});\n\n\t\t\tthis.setState({\n\t\t\t\tlists: lists\n\t\t\t});\n\t\t});\n\n\t\t//new\n\t\tref = firebase.database().ref('movie-lists');\n\t\tref.orderByKey().on('value', snapshot => {\n\t\t\tif (!snapshot.val()) return;\n\t\t\t\n\t\t\tlet movieLists = [];\n\n\t\t\tObject.values(snapshot.val()).forEach(movieListPair => {\n\t\t\t\tlet pair = Object.entries(movieListPair)[0];\n\t\t\t\tmovieLists.push(pair[0] + ' - ' + pair[1]);\n\t\t\t});\n\n\t\t\tthis.setState({\n\t\t\t\tmovieListPairs: movieLists\n\t\t\t});\n\t\t});\n\t\tref = firebase.database().ref('graph');\n\t\tref.on('child_added', snapshot => {\n\t\t\tlet movie = snapshot.val();\n\n\t\t\tlet movies = this.state.graphList;\n\t\t\tmovies.push(movie);\n\n\t\t\tthis.setState({\n\t\t\t\t'graphList': movies\n\t\t\t});\n\t\t});\n\t\tref.on('child_removed', snapshot => {\n\t\t\tlet movie = snapshot.val();\n\n\t\t\tlet movies = this.state.graphList;\n\t\t\tfor (let i = 0; i < movies.length; i++) {\n\t\t\t\tif (movies[i].id === movie.id) {\n\t\t\t\t\tmovies.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\t'graphList': movies\n\t\t\t});\n\n\t\t});\n\t\t//new\n\n\n    }\n    // componentWillUnmount() {\n    //     this.;\n    // }\n\n\tloadMovies = () => {\n\t\tif (this.state.currentList.name === 'All') {\n\t\t\tlet ref = firebase.database()\n\t\t\t\t.ref('movies')\n\t\t\t\t.orderByChild('title')\n\t\t\t\t.limitToFirst(this.state.moviesToLoad);\n\t\t\t\n\t\t\tref.on('child_added', snapshot => {\n\t\t\t\tlet movie = snapshot.val();\n\t\t\t\tlet last = movie.title;\n\t\t\t\t// console.log(movie);\n\n\t\t\t\tlet movies = this.state.movies;\n\t\t\t\tmovies.push(movie);\n\n\t\t\t\tthis.setState({\n\t\t\t\t\t'movies': movies,\n\t\t\t\t\t'last': last,\n\t\t\t\t\t'loaded': this.state.loaded + 1 % this.state.moviesToLoad,\n\t\t\t\t\t'loading': this.state.loaded + 1 < this.state.moviesToLoad\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tlet movieIDs = this.getID();\n\t\t\n\t\tmovieIDs.forEach(movieID => {\n\t\t\tlet ref = firebase.database()\n\t\t\t\t.ref('movies')\n\t\t\t\t.orderByChild('id')\n\t\t\t\t.equalTo(movieID)\n\t\t\t\t.limitToFirst(1);\n\n\t\t\tref.on('child_added', snapshot => {\n\t\t\t\tlet movie = snapshot.val();\n\t\t\t\tlet last = movie.title;\n\t\n\t\t\t\tif (this.state.currentList.name !== 'All') {\n\t\t\t\t\tlet show = false;\n\t\t\t\t\tmovieIDs.forEach(movieID => {\n\t\t\t\t\t\tif (movie.id === movieID) show = true;\n\t\t\t\t\t});\n\t\t\t\t\tif (!show) return;\n\t\t\t\t}\n\t\n\t\t\t\tlet movies = this.state.movies;\n\t\t\t\tmovies.push(movie);\n\t\n\t\t\t\tthis.setState({\n\t\t\t\t\t'movies': movies,\n\t\t\t\t\t'last': last,\n\t\t\t\t\t'loaded': this.state.loaded + 1 % this.state.moviesToLoad,\n\t\t\t\t\t'loading': this.state.loaded + 1 < this.state.moviesToLoad\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tloadMore = () => {\n\t\tif (this.state.loading) return;\n\t\t\n\t\tthis.setState({\n\t\t\tloading: true,\n\t\t\tloaded: 0\n\t\t});\n\t\t\n\t\tlet ref = firebase.database()\n\t\t\t.ref('movies')\n\t\t\t.orderByChild('title')\n\t\t\t.startAt(this.state.last)\n\t\t\t.limitToFirst(this.state.moviesToLoad + 1);\n\n\t\tlet movieIDs = [];\n\t\tif (this.state.currentList.name !== 'All') movieIDs = this.getID();\n\n\t\tref.on('child_added', snapshot => {\n\t\t\tconst movie = snapshot.val();\n\n\t\t\tlet duplicate = false;\n\t\t\tthis.state.movies.forEach(m => {\n\t\t\t\tif (m.id === movie.id) duplicate = true;\n\t\t\t});\n\t\t\tif (duplicate) return;\n\n\t\t\tif (this.state.currentList.name !== 'All') {\n\t\t\t\tlet show = false;\n\t\t\t\tmovieIDs.forEach(movieID => {\n\t\t\t\t\tif (movie.id === movieID) show = true;\n\t\t\t\t});\n\t\t\t\tif (!show) return;\n\t\t\t}\n\n\t\t\tlet movies = this.state.movies;\n\t\t\tmovies.push(movie);\n\n\t\t\tlet last = movie.title;\n\n\t\t\tthis.setState({\n\t\t\t\t'movies': movies,\n\t\t\t\t'last': last,\n\t\t\t\t'loaded': this.state.loaded + 1 % this.state.moviesToLoad,\n\t\t\t\t'loading': this.state.loaded + 1 < this.state.moviesToLoad\n            });\n            // if ()\n\t\t});\n\t}\n\n\taddMovie = (event) => {\n\t\tevent.preventDefault();\n\t\t\n\t\tif (this.state.movieID.slice(0, 2) !== 'tt' || !/^\\d+$/.test(this.state.movieID.slice(2))) {\n\t\t\tconst title = this.state.movieID;\n\n\t\t\tthis.setState({\n\t\t\t\t'movieID': ''\n\t\t\t});\n\n\t\t\tAxios.get('https://www.omdbapi.com/?apikey=' + 'ec05d9ae' + '&t=' + title)\n\t\t\t.then(response => {\n\t\t\t\tif (response.data.Response === 'False') {\n\t\t\t\t\talert('Movie cannot be found! Try another one.');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet duplicate = false;\n\t\t\t\tthis.state.movies.forEach(movie => {\n\t\t\t\t\tif (movie.id === response.data.imdbID) duplicate = true;\n\t\t\t\t});\n\n\t\t\t\tif (duplicate) {\n\t\t\t\t\talert('Movie existed!');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet movie = [];\n\t\t\t\tmovie.id = response.data.imdbID;\n\t\t\t\tmovie.title = response.data.Title;\n\t\t\t\tmovie.director = response.data.Director;\n\t\t\t\tmovie.year = response.data.Year;\n\t\t\t\tmovie.plot = response.data.Plot;\n\t\t\t\tmovie.rating = response.data.imdbRating;\n\t\t\t\tmovie.poster = response.data.Poster;\n\t\t\t\tmovie.actors = response.data.Actors.split(', ');\n\n                firebase.database().ref('movies').push().set(movie);\n\t\t\t\t\n\t\t\t});\n            \n\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = this.state.movieID;\n\n\t\tthis.setState({\n\t\t\t'movieID': ''\n\t\t});\n\t\t\n\t\tlet duplicate = false;\n\t\tthis.state.movies.forEach(movie => {\n\t\t\tif (movie.id === id) duplicate = true;\n\t\t});\n\n\t\tif (duplicate) {\n\t\t\talert('Movie existed!');\n\t\t\treturn;\n\t\t}\n\n\n\t\tAxios.get('https://www.omdbapi.com/?apikey=' + 'ec05d9ae' + '&i=' + id)\n\t\t.then(response => {\n\t\t\tif (response.data.Response === 'False') {\n\t\t\t\talert('Movie not found!');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet movie = [];\n\t\t\tmovie.id = id;\n\t\t\tmovie.title = response.data.Title;\n\t\t\tmovie.director = response.data.Director;\n\t\t\tmovie.year = response.data.Year;\n\t\t\tmovie.plot = response.data.Plot;\n            movie.rating = response.data.imdbRating;\n\t\t\tmovie.poster = response.data.Poster;\n\t\t\tmovie.actors = response.data.Actors.split(', ');\n            firebase.database().ref('movies').push().set(movie);\n            window.scrollTo({\n                top: document.body.scrollHeight,\n                behavior: 'smooth'\n            });\n\n\t\t});\n\t}\n\n\taddList = (event) => {\n\t\tevent.preventDefault();\n\t\tconsole.log('addList: ' + this.state.listName);\n\t\t\n\t\tlet listName = this.state.listName;\n\t\t\n\t\tthis.setState({\n\t\t\t'listName': ''\n\t\t});\n\n\t\tlet duplicate = false;\n\t\tObject.entries(this.state.lists).forEach(list => {\n\t\t\tif (listName.toLowerCase() === list[1].toLowerCase()) duplicate = true;\n\t\t});\n\t\tif (duplicate) {\n\t\t\talert('List already exists!');\n\t\t\treturn;\n\t\t};\n\t\t\n\t\tlet ref = firebase.database().ref('lists');\n\t\tlet listRefKey = ref.push().key;\n\t\t\n\t\tlet updates = {};\n\t\tupdates['/lists/' + listRefKey + '/id'] = listRefKey;\n\t\tupdates['/lists/' + listRefKey + '/name'] = listName;\n        alert('List is successfully added!');\n\t\tfirebase.database().ref().update(updates);\n\t}\n\n\tgetupdatess = () => {\n\t\treturn Object.entries(this.state.lists).map(list => (\n\t\t\t<option key={list[0]}\n\t\t\t\tvalue={list[0]}>{list[1]}</option>\n\t\t));\n\t}\n\n\tgetAddToLists = (id) => {\n\t\treturn Object.entries(this.state.lists).map((list, i) => (\n\t\t\t<option key={list[0]}\n\t\t\t\tvalue={list[0]}>{list[1]}</option>\n\t\t));\n\t}\n\n\tupdates = (event) => {\n\t\tlet listName = '';\n\t\tif (event.target.value === '') {\n\t\t\tlistName = 'All';\n\t\t} else {\n\t\t\tlistName = this.state.lists[event.target.value];\n\t\t}\n\n\t\tthis.setState({\n\t\t\tmovies: [],\n\t\t\tcurrentList: {id: event.target.value, name: listName},\n\t\t\tloaded: 0,\n\t\t\tloading: true\n\t\t});\n\n\t\tthis.forceUpdate(this.loadMovies);\n\t}\n\n\taddToList = (event, movieID, movieClass) => {\n\t\tlet listID = event.target.value;\n\t\tlet duplicate = false;\n\t\tthis.state.movieListPairs.forEach(movieListPair => {\n\t\t\tlet pair = movieListPair.split(' - ');\n\t\t\tif (pair[0] === listID && pair[1] === movieID) duplicate = true;\n\t\t});\n\t\tif (duplicate) {\n\t\t\talert('Movie already in the selected list!');\n\t\t\treturn;\n\t\t};\n\n\t\talert('Added ' + movieID + ' to ' +  this.state.lists[event.target.value]);\n\t\t\n\t\tif (this.state.lists[event.target.value] == \"GraphViz\"){\n\t\t\tthis.addGraph(movieClass)\n\t\t\talert('Now you can find ' + movieClass.title + \" in Graph!\" );\n\t\t};\n\t\t\n\t}\n\n\tgetID = () => {\n\t\tlet movieIDs = [];\n\t\tthis.state.movieListPairs.forEach(movieListPair => {\n\t\t\tif (movieListPair.search(this.state.currentList.id) > -1) {\n\t\t\t\tmovieIDs.push(movieListPair.slice((this.state.currentList.id + ' - ').length));\n\t\t\t}\n\t\t});\n\n\t\treturn movieIDs;\n\t}\n\n\tsearch = (event) => {\n\t\tevent.preventDefault();\n\t}\n\n\tcheckGraphMovie = (id) => {\n\t\tlet movies = this.state.graphList;\n\t\tfor (let i = 0; i < movies.length; i++) {\n\t\t\tif (movies[i].id === id) return true;\n\t\t}\n\t\treturn false;\n\t}\n\n\taddGraph = (movie) => {\t\t\n\t\tlet exists = this.checkGraphMovie(movie.id);\n\t\t\n\t\tif (exists) {\n\t\t\tlet ref = firebase.database().ref('graph');\n\t\t\tlet removeMovie = ref.orderByChild('id').equalTo(movie.id).limitToFirst(1).on('child_added', snapshot => {\n\t\t\t\tref.child(snapshot.key).remove();\n\t\t\t});\n\t\t\tref.off('child_added', removeMovie);\n\t\t} else {\n\t\t\tconsole.log(movie.title);\n\t\t\talert('Current movie is not in graph');\n\n\t\t\tfirebase.database().ref('graph').push().set(movie);\n\t\t}\n\t\tthis.displayLightbox(movie);\n\t}\n\n\tdeleteMovie = (movieID) => {\n\t\tconsole.log('deleteMovie');\n\t\tlet ref = firebase.database().ref('movies');\n\t\t\n\t\tref.orderByChild('id').equalTo(movieID).limitToFirst(1).on('child_added', snapshot => {\n\t\t\tconsole.log(snapshot.key);\n\t\t\tref.child(snapshot.key).remove();\n\t\t});\n\n\t\tlet movies = this.state.movies;\n\t\t\n\t\tlet toDelete = -1;\n\t\tmovies.forEach((movie, i) => {\n\t\t\tif (movie.id === movieID) toDelete = i;\n\t\t});\n\t\tmovies.splice(toDelete, 1);\n\n\t\tthis.setState({movies: movies});\n\n\t\tPopupboxManager.close();\n\t}\n\n\thandleChange = (event) => {\n\t\tthis.setState({\n\t\t\t[event.target.name]: event.target.value\n\t\t});\n\t}\n\n\tlockScroll = () => {\n\t\tdocument.body.style.overflow = 'hidden';\n\t}\n\n\tunlockScroll = () => {\n\t\tdocument.body.style.overflow = 'inherit';\n    }\n    dimPoster(e) {\n        e.target.style.opacity = 0.5;\n      }\n    \n    resetPoster(e) {\n        e.target.style.opacity = 1;\n    }\n\n\tdisplayMovies = () => {\n\t\treturn this.state.movies.filter(movie => movie.title.toLowerCase().includes(this.state.searchQuery)).map(movie => (\n\t\t\t<img className=\"moviePoster\" src={movie.poster}\n                key={movie.id} alt=\"\"\n                onMouseEnter={this.dimPoster} onMouseLeave={this.resetPoster}\n\t\t\t\tonClick={this.displayLightbox.bind(this, movie)}/>\n\t\t));\n\t}\n\n\tdisplayLightbox = (movie) => {\n\t\tconst content = (\n\t\t\t\n            <div className=\"movLightboxContainer\">\n\t\t\t\t<img className=\"movLightboxImage\" src={movie.poster} alt=\"\"/>\n\t\t\t\t<div className = \"movLightboxContent\">\n\t\t\t\t\t<span className = \"title\">{movie.title}</span>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<span className = \"director\">Directed by: <b>{movie.director}</b></span>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<p>{movie.plot}</p>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<span className = \"rating\">Rating: <b>{movie.rating}</b></span>\n                    <br></br>\n\t\t\t\t\t<br></br>\n                    <div>\n\t\t\t\t\t\t<select className=\"dropdown\" value={this.state.addToListName} onChange={event => {this.addToList(event, movie.id, movie)}}>\n\t\t\t\t\t\t\t<option hidden value=\"\">Add to List</option>\n                             {this.getAddToLists(movie.id)}\n                             \n                        </select>\n\n\t\t\t \t\t</div>\n                    <br></br>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<div>\n\t\t\t\t\t<button className=\"add-to-graph-button\" onClick={() => this.addGraph(movie)}>\n\t\t\t\t\t\t\t{this.checkGraphMovie(movie.id) ? 'Remove from Graph' : 'Checking in graph'}\n\t\t\t\t\t</button>\n                    \n                        <button className=\"delete-button-add\" onClick={() => {this.deleteMovie(movie.id)}}>Delete From Collection</button>\n                    </div>\n\t\n\t\t\t\t</div>\n\t\t\t\n\t\t\t</div>\n\t\t)\n\n\t\tPopupboxManager.open({content,\n\t\t\tconfig: {\n\t\t\t\tonOpen: this.lockScroll,\n\t\t\t\tonClosed: this.unlockScroll\n\t\t\t}\n\t\t});\n    }\n\n\n\trender() {\n\t\tconst popupboxConfig = {\n\t\t\tstyle: {\n\t\t\t\toverflow: 'inherit'\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<h1>Movies Collection </h1>\n\t\t\t\t\n\t\t\t\t<div className=\"movie-forms\">\n                    <div className=\"dropdown\">\n\t\t\t\t\t\t\t<select  onChange={this.updates} >\n\t\t\t\t\t\t\t\t<option value=\"\">All</option>\n                                {this.getupdatess()}\n                                \n                            </select>\n                            \n                        \n                            \n                            \n\t\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"movie-add-forms\">\n                        \n\t\t\t\t\t\t<form className=\"movie-form\" onSubmit={e => this.addMovie(e)}>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<input type=\"text\"\n\t\t\t\t\t\t\t\t\tname=\"movieID\"\n\t\t\t\t\t\t\t\t\tclassName=\"form-input-text\"\n\t\t\t\t\t\t\t\t\tvalue={this.state.movieID}\n\t\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Movie title or IMDB ID\"/>\n                                \n                                <input type='submit' value='Add a Movie'/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\n\t\t\t\t\t\t<form className=\"movie-form\" onSubmit={e => this.addList(e)}>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<input type=\"text\"\n\t\t\t\t\t\t\t\t\tname=\"listName\"\n\t\t\t\t\t\t\t\t\tclassName=\"form-input-text\"\n\t\t\t\t\t\t\t\t\tvalue={this.state.listName}\n\t\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Enter a new list name\"/>\n                                <input type='submit' value='Create List'/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<form className=\"movie-form\" onSubmit={e => this.search(e)}>\n\t\t\t\t\t\t<div>\n                        <label><span>Search By Name: </span></label>\n                        <div>\n\t\t\t\t\t\t\t<input type=\"text\"\n\t\t\t\t\t\t\t\tname=\"searchQuery\"\n\t\t\t\t\t\t\t\tclassName=\"form-input-text\"\n\t\t\t\t\t\t\t\tvalue={this.state.searchQuery}\n\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\tplaceholder=\"Enter a name\"/>\n                        </div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\n\t\t\t\t\t</div>\n\n\t\t\t\t\t\n\t\t\t\t\t<div></div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div className=\"movies\"\n\t\t\t\t\tref={this.moviesScroll}>\n\t\t\t\t\t{this.displayMovies()}\n\n\t\t\t\t\t<PopupboxContainer { ...popupboxConfig } />\n\t\t\t\t</div>\n                <div className='button'>\n                {!(this.state.loading) && <button className = 'but' onClick={this.loadMore}>Load More ...</button>}\n                </div>\n\t\t\t</div>\n\n\t\t);\n\t}\n}\n\nexport default AddMovie;"]},"metadata":{},"sourceType":"module"}